<html>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <head>
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
        <script src="../js/app.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
        
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        <!-- Optional theme -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        
    </head>
    
    <body ng-app="map" ng-controller="mapCtrl">
        
        <nav class="navbar navbar-default" style="margin-bottom: 0px;"r>
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="#">Red Cross | Jon Doe | Map </a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

              <ul class="nav navbar-nav navbar-right">
                <li><a href="../html/volunteer-map.html">Map</a></li>
                <li><a href="../html/volunteer-notifications.html">Notification</a></li>
                <li><a href="../html/volunteer-profile.html">Profile</a></li>
              </ul>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
        
        
        
        
        <!-- Map -->
        
 
            <div id="map" style="height: 90vh; width: 100%;">
                                
                    <marker ng-repeat="request in requests track by $index" position="{{request.location}}"></marker>
                </ng-map>
            </div>
 
        
        <script>
      function initMap() {
        var myLatLng = {lat: 59.7047, lng: 16.1910};
        var requests = [
                {
                    "user":"Anders Wall",
                    "user-id":1,
                    "location":[59.32839790000001,18.0632844],
                    "title": "Homework hessslp",
                    "description":"I need help with my homeworks",
                    "deadline":'2016-06-28 20:18',
                    "phone": '+460707708633',
                    "categories":['homeworks']
                },
                {
                    "user":"Sarah Jonsson",
                    "user-id":3,
                    "location":[59.32839790000001,18.2632844],
                    "title": "Homework help",
                    "description":"I need help with food for tonight",
                    "deadline":'2016-05-28 20:18',
                    "phone": '+460707708633',
                    "categories":['food']
                },
                {
                    "user":"Bob Eriksson",
                    "user-id":2,
                    "location":[59.32839790000001,18.4632844],
                    "title": "Homework help",
                    "description":"I need help with writing a CV",
                    "deadline":'2016-05-28 20:18',
                    "phone": '+460707708633',
                    "categories":['language']
                }
        ];
          
        // Create a map object and specify the DOM element for display.
        var map = new google.maps.Map(document.getElementById('map'), {
          center: myLatLng,
          scrollwheel: false,
          zoom: 8
        });
          
        
        var markers = [];
          
        var infowindow = new google.maps.InfoWindow({
            content: 'loading'
        });

        for(var i=0; i<requests.length; i++){
            var request = requests[i];
            var marker = new google.maps.Marker({
              map: map,
              position: {lat: request.location[0], lng: request.location[1]},
              title: request.title,
              description: request.description,
              deadline: request.deadline,
              user: request.user,
              phone: request.phone
            });
            
            markers[i] = marker;
            
            marker.addListener('click', function() {
              infowindow.setContent( '<div id="content">'+
            '<div id="siteNotice">'+
            '</div>'+
            '<h1 id="firstHeading" class="firstHeading">'+this.title+'</h1>'+
            '<div id="bodyContent">'+
            '<p>'+this.description+'</p>'+
            '<p><b>Time:</b> '+this.deadline+'</p>'+
            '<p><b>Phone:</b> '+this.phone+'</p>'+
            '<p>'+this.user+'</p>'+
            '<p><em>Call person to arrange meetup.</em></p>'+
            '<button type="button" class="btn btn-success">I Will Support</button>'+
            '</div>'+
            '</div>');
              infowindow.open(map, this);
            });
            
        }
          
        
      }
            
        var app = angular.module('map', [])
        app.controller('mapCtrl', function($scope){
        })
        
    </script>
        
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDMOQ5ntPst9DhScYdGruqXZ9pO0JLHjPw&callback=initMap"
        async defer></script>
    </body>
</html>